** Overview

This phase configures privacy infrastructure - foundational services and applications:
- Install and configure Tor for network anonymity
- Install and configure I2P for P2P network privacy
- Install Tor Browser for web browsing
- Install and configure KeePassXC for password management

All network routing infrastructure is established here. Application-specific wrappers (git, SSH, etc.) are configured in Phase 4.

**Network privacy model:**
- Web browsing: Tor Browser (fingerprint resistance)
- Monero node: I2P + Tor (configured in monerod phase)
- Application wrappers: Use Tor SOCKS proxy (Phase 4)

**Note on account management:** For high-security operations (crypto wallets, account registration), use hardware wallet + Tor Browser. Future documentation will cover hardware wallet setup.

See Appendix F: Threat Models for security model and trade-offs.

** Configuration Variables

Tor Browser version is configurable in config.yml. Check https://www.torproject.org/download/ for latest version.

** Tor Daemon

*** Install Tor

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # Privacy Infrastructure
    # ------------------------------------------------------------------------

    - name: Install Tor
      community.general.pacman:
        name:
          - tor
          - torsocks
        state: present
      tags: [privacy, tor]
#+end_src

*** Tor Configuration Template

#+begin_src conf :tangle ../configs/templates/torrc.j2
## Tor Configuration for Privacy-First Operation
## Generated from org/03-privacy.org

# SOCKS proxy for application wrappers
SOCKSPort {{ tor_socks_port }}
SOCKSPolicy accept 127.0.0.1

# DNS
DNSPort {{ tor_dns_port }}

# Control port (for monitoring)
ControlPort {{ tor_control_port }}
CookieAuthentication 1

# Data directory
DataDirectory /var/lib/tor

# Logging
Log notice file /var/log/tor/notices.log

# Client only (not a relay)
ClientOnly 1

# Use entry guards
UseEntryGuards 1

# Circuits
CircuitBuildTimeout 60
LearnCircuitBuildTimeout 1
NewCircuitPeriod 30

# Don't write to disk immediately (privacy)
AvoidDiskWrites 1

# Disable geolocation
GeoIPFile /dev/null
GeoIPv6File /dev/null

# Strict exit node policy
ExitPolicyRejectPrivate 1
#+end_src

*** Deploy Tor Configuration

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    - name: Deploy Tor configuration
      template:
        src: ../configs/templates/torrc.j2
        dest: /etc/tor/torrc
        mode: '0644'
        owner: root
        group: root
      notify: restart tor
      tags: [privacy, tor, config]

    - name: Create Tor log directory
      file:
        path: /var/log/tor
        state: directory
        owner: tor
        group: tor
        mode: '0755'
      tags: [privacy, tor]

    - name: Create Tor data directory with proper ownership
      file:
        path: /var/lib/tor
        state: directory
        owner: tor
        group: tor
        mode: '0700'
      tags: [privacy, tor]

    - name: Create systemd override directory for Tor
      file:
        path: /etc/systemd/system/tor.service.d
        state: directory
        mode: '0755'
      tags: [privacy, tor]

    - name: Configure Tor to run as tor user
      copy:
        content: |
          [Service]
          User=tor
          Group=tor
        dest: /etc/systemd/system/tor.service.d/user.conf
        mode: '0644'
      notify: reload systemd
      tags: [privacy, tor]

    - name: Reload systemd daemon for Tor
      systemd:
        daemon_reload: yes
      tags: [privacy, tor]

    - name: Enable and start Tor service
      systemd:
        name: tor
        enabled: yes
        state: started
      tags: [privacy, tor]
#+end_src

** I2P Daemon

*** Install i2pd

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # I2P Network Privacy
    # ------------------------------------------------------------------------

    - name: Install i2pd
      community.general.pacman:
        name:
          - i2pd
        state: present
      tags: [privacy, i2p]
#+end_src

*** Configure i2pd

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    - name: Create i2pd tunnels config directory
      file:
        path: /etc/i2pd/tunnels.d
        state: directory
        owner: i2pd
        group: i2pd
        mode: '0755'
      tags: [privacy, i2p, config]
#+end_src

*** Monero I2P Server Tunnels

#+begin_src conf :tangle ../configs/templates/monero-i2p.conf.j2
# I2P Server Tunnels for Monero
# Generated from org/03-privacy-infra.org

[monero-node]
type = server
host = 127.0.0.1
# Anonymous inbound port (P2P)
port = 18085
inport = 0
keys = monero-mainnet.dat

[monero-rpc]
type = server
host = 127.0.0.1
# Restricted RPC port (for wallet connections)
port = 18089
keys = monero-mainnet.dat
#+end_src

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    - name: Deploy Monero I2P tunnel configuration
      template:
        src: ../configs/templates/monero-i2p.conf.j2
        dest: /etc/i2pd/tunnels.d/monero-mainnet.conf
        owner: i2pd
        group: i2pd
        mode: '0644'
      notify: restart i2pd
      tags: [privacy, i2p, config]
#+end_src

*** Enable and Start i2pd

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    - name: Enable and start i2pd service
      systemd:
        name: i2pd
        enabled: yes
        state: started
      tags: [privacy, i2p]

    - name: Wait for i2pd to generate tunnel address
      pause:
        seconds: 15
      tags: [privacy, i2p]
#+end_src

*** Retrieve I2P Address

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    - name: Check I2P web console accessibility
      uri:
        url: http://127.0.0.1:7070
        method: GET
        timeout: 5
      register: i2p_console_check
      failed_when: false
      tags: [privacy, i2p, verify]

    - name: Retrieve I2P tunnel address from web console
      shell: |
        curl -s http://127.0.0.1:7070/?page=i2p_tunnels 2>/dev/null | \
        grep -oP '[a-z0-9]{52}\.b32\.i2p' | \
        head -1
      register: i2p_address_raw
      changed_when: false
      failed_when: false
      when: i2p_console_check.status == 200
      tags: [privacy, i2p, verify]

    - name: Create monero config directory
      file:
        path: /etc/monero
        state: directory
        mode: '0755'
      tags: [privacy, i2p, config]

    - name: Save I2P address to file for monerod
      copy:
        content: "{{ i2p_address_raw.stdout | default('') }}"
        dest: /etc/monero/i2p-address.txt
        mode: '0644'
      when:
        - i2p_address_raw.stdout is defined
        - i2p_address_raw.stdout != ""
      tags: [privacy, i2p, config]
#+end_src

*** I2P Status Script

#+begin_src bash :tangle ../configs/templates/i2p-status.sh.j2
#!/bin/bash
# I2P Status Script
# Generated from org/03-privacy-infra.org

GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${GREEN}=== I2P Status ===${NC}"
echo ""

# Service status
if systemctl is-active --quiet i2pd; then
  echo -e "${GREEN}✓ i2pd service running${NC}"
else
  echo -e "${YELLOW}✗ i2pd service NOT running${NC}"
  exit 1
fi

echo ""

# I2P address
if [ -f /etc/monero/i2p-address.txt ]; then
  I2P_ADDR=$(cat /etc/monero/i2p-address.txt)
  if [ -n "$I2P_ADDR" ]; then
    echo "--- Monero I2P Address ---"
    echo "  $I2P_ADDR"
  else
    echo -e "${YELLOW}⚠ I2P address file exists but is empty${NC}"
    echo "  Tunnels may still be initializing"
  fi
else
  echo -e "${YELLOW}⚠ I2P address not yet generated${NC}"
  echo "  Check web console: http://127.0.0.1:7070/?page=i2p_tunnels"
fi

echo ""

# Tunnel status via web console
echo "--- I2P Tunnel Status ---"
if curl -s --max-time 3 http://127.0.0.1:7070/?page=i2p_tunnels 2>/dev/null | grep -q "monero-node"; then
  echo -e "${GREEN}✓ Monero tunnels configured${NC}"
  TUNNELS=$(curl -s http://127.0.0.1:7070/?page=i2p_tunnels 2>/dev/null | grep -c "monero")
  echo "  Found $TUNNELS monero tunnel(s)"
  # Extract I2P address
  I2P_ADDR=$(curl -s http://127.0.0.1:7070/?page=i2p_tunnels 2>/dev/null | grep -oP '[a-z0-9]{52}\.b32\.i2p' | head -1)
  if [ -n "$I2P_ADDR" ]; then
    echo "  Address: $I2P_ADDR"
  fi
else
  echo -e "${YELLOW}⚠ Could not verify tunnel status${NC}"
fi

echo ""
echo "--- Commands ---"
echo "  Web console: http://127.0.0.1:7070"
echo "  Tunnels page: http://127.0.0.1:7070/?page=i2p_tunnels"
echo "  Logs: journalctl -u i2pd -f"
echo "  Restart: systemctl restart i2pd"
echo ""
#+end_src

** Tor Browser

*** Download and Install

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # Tor Browser
    # ------------------------------------------------------------------------

    - name: Check if Tor Browser is installed
      stat:
        path: /opt/tor-browser
      register: tor_browser_check
      tags: [privacy, browser]

    - name: Create Tor Browser directory
      file:
        path: /opt/tor-browser
        state: directory
        owner: "{{ dev_user }}"
        group: "{{ dev_user }}"
        mode: '0755'
      when: not tor_browser_check.stat.exists
      tags: [privacy, browser]

    - name: Download Tor Browser checksums
      get_url:
        url: "https://dist.torproject.org/torbrowser/{{ tor_browser_version }}/sha256sums-signed-build.txt"
        dest: /tmp/tor-browser-checksums.txt
        mode: '0644'
      when: not tor_browser_check.stat.exists
      tags: [privacy, browser]

    - name: Extract checksum for our file
      shell: |
        grep "tor-browser-linux-x86_64-{{ tor_browser_version }}.tar.xz$" /tmp/tor-browser-checksums.txt | awk '{print $1}'
      register: tor_browser_checksum
      changed_when: false
      when: not tor_browser_check.stat.exists
      tags: [privacy, browser]

    - name: Download Tor Browser
      get_url:
        url: "https://www.torproject.org/dist/torbrowser/{{ tor_browser_version }}/tor-browser-linux-x86_64-{{ tor_browser_version }}.tar.xz"
        dest: /tmp/tor-browser.tar.xz
        mode: '0644'
        checksum: "sha256:{{ tor_browser_checksum.stdout }}"
      when: not tor_browser_check.stat.exists
      tags: [privacy, browser]
      register: tails_download

    - name: Extract Tor Browser
      unarchive:
        src: /tmp/tor-browser.tar.xz
        dest: /opt/tor-browser
        remote_src: yes
        owner: "{{ dev_user }}"
        group: "{{ dev_user }}"
        extra_opts: [--strip-components=1]
      when: not tor_browser_check.stat.exists
      tags: [privacy, browser]

    - name: Create Tor Browser launcher script
      copy:
        content: |
          #!/bin/bash
          cd /opt/tor-browser/Browser
          ./start-tor-browser "$@"
        dest: /usr/local/bin/tor-browser
        mode: '0755'
      tags: [privacy, browser]

    - name: Create Tor Browser desktop entry
      copy:
        content: |
          [Desktop Entry]
          Version=1.0
          Type=Application
          Name=Tor Browser
          GenericName=Web Browser
          Comment=Browse the web anonymously through Tor
          Exec=/usr/local/bin/tor-browser
          Icon=/opt/tor-browser/Browser/browser/chrome/icons/default/default128.png
          Terminal=false
          Categories=Network;WebBrowser;Security;
          Keywords=internet;web;browser;privacy;anonymous;tor;
          StartupNotify=true
        dest: /usr/share/applications/tor-browser.desktop
        mode: '0644'
      tags: [privacy, browser]

    - name: Set Tor Browser as default browser
      copy:
        content: |
          [Default Applications]
          x-scheme-handler/http=tor-browser.desktop
          x-scheme-handler/https=tor-browser.desktop
          text/html=tor-browser.desktop
        dest: "/home/{{ dev_user }}/.config/mimeapps.list"
        owner: "{{ dev_user }}"
        group: "{{ dev_user }}"
        mode: '0644'
      tags: [privacy, browser]

    - name: Clean up Tor Browser download
      file:
        path: /tmp/tor-browser.tar.xz
        state: absent
      tags: [privacy, browser]
#+end_src

** Browser Dispatcher

*** Dispatcher Script Template

#+begin_src python :tangle ../configs/templates/browser-dispatch.j2
#!/usr/bin/env python3
"""Browser dispatcher with domain-based routing for privacy-first browsing."""

import sys
import json
import os
from urllib.parse import urlparse
from pathlib import Path


def load_config() -> dict:
    """Load dispatcher configuration."""
    config_file = Path("/etc/browser-dispatch.json")

    if not config_file.exists():
        return {"kyc_domains": [], "kyc_profile_dir": "/home/dev/.config/chromium/kyc-identity"}

    try:
        return json.loads(config_file.read_text())
    except (json.JSONDecodeError, OSError):
        return {"kyc_domains": [], "kyc_profile_dir": "/home/dev/.config/chromium/kyc-identity"}


def main() -> None:
    if len(sys.argv) < 2:
        sys.exit(1)

    url = sys.argv[1]
    domain = urlparse(url).netloc.lower()
    config = load_config()

    kyc_domains = {d.lower() for d in config.get("kyc_domains", [])}
    kyc_profile_dir = config.get("kyc_profile_dir", "/home/dev/.config/chromium/kyc-identity")

    if domain in kyc_domains:
        # KYC identity sites → Chromium with kyc-identity profile
        os.execvp("chromium", ["chromium", f"--user-data-dir={kyc_profile_dir}", url])
    else:
        # Privacy-first default → Tor Browser
        os.execvp("tor-browser", ["tor-browser", url])


if __name__ == "__main__":
    main()
#+end_src

*** Desktop Entry Template

#+begin_src conf :tangle ../configs/templates/browser-dispatch.desktop.j2
[Desktop Entry]
Version=1.0
Type=Application
Name=Browser Dispatcher
GenericName=Web Browser
Comment=Privacy-first browser dispatcher
Exec=/usr/local/bin/browser-dispatch %u
Icon=web-browser
Terminal=false
Categories=Network;WebBrowser;
MimeType=text/html;text/xml;application/xhtml+xml;x-scheme-handler/http;x-scheme-handler/https;
StartupNotify=true
#+end_src

*** Deploy Browser Dispatcher

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # Browser Dispatcher
    # ------------------------------------------------------------------------

    - name: Deploy browser dispatcher script
      template:
        src: ../configs/templates/browser-dispatch.j2
        dest: /usr/local/bin/browser-dispatch
        mode: '0755'
      tags: [privacy, browser-dispatch]

    - name: Create initial browser dispatch config
      copy:
        content: |
          {
            "kyc_domains": []
          }
        dest: /etc/browser-dispatch.json
        mode: '0644'
        force: no
      tags: [privacy, browser-dispatch]

    - name: Deploy browser dispatcher desktop entry
      template:
        src: ../configs/templates/browser-dispatch.desktop.j2
        dest: /usr/share/applications/browser-dispatch.desktop
        mode: '0644'
      tags: [privacy, browser-dispatch]

    - name: Set browser dispatcher as default browser
      become: yes
      become_user: "{{ dev_user }}"
      shell: |
        xdg-settings set default-web-browser browser-dispatch.desktop
        xdg-mime default browser-dispatch.desktop x-scheme-handler/http
        xdg-mime default browser-dispatch.desktop x-scheme-handler/https
        xdg-mime default browser-dispatch.desktop text/html
      tags: [privacy, browser-dispatch]

    - name: Verify browser dispatcher installation
      stat:
        path: /usr/local/bin/browser-dispatch
      register: browser_dispatch_installed
      tags: [privacy, browser-dispatch, verify]

    - name: Display browser dispatcher status
      debug:
        msg:
          - "=== Browser Dispatcher Installed ==="
          - ""
          - "Script: {% if browser_dispatch_installed.stat.exists %}Installed{% else %}Not found{% endif %}"
          - "Config: /etc/browser-dispatch.json (empty - populate in Phase 4)"
          - ""
          - "Current behavior:"
          - "  - All URLs → Tor Browser (privacy-first default)"
          - ""
          - "After Phase 4 configuration:"
          - "  - KYC domains → Chromium with kyc-identity profile"
          - "  - All other URLs → Tor Browser"
          - ""
          - "Chromium profiles auto-create on first use (no manual setup needed)"
          - ""
      tags: [privacy, browser-dispatch, verify]
#+end_src

** KeePassXC

*** Install KeePassXC

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # KeePassXC Password Manager
    # ------------------------------------------------------------------------

    - name: Install KeePassXC
      community.general.pacman:
        name:
          - keepassxc
        state: present
      tags: [privacy, keepassxc]
#+end_src

*** Configuration Template

#+begin_src ini :tangle ../configs/templates/keepassxc.ini.j2
[General]
ConfigVersion=2
LastDir=/home/{{ dev_user }}/Documents

[Security]
LockDatabaseIdle=false
LockDatabaseIdleSeconds=300
LockDatabaseMinimize=false
LockDatabaseScreenLock=false
IconDownloadFallback=false

[Browser]
Enabled=false

[PasswordGenerator]
Length=32
SpecialChars=true
Numbers=true
LowerCase=true
UpperCase=true

[GUI]
MinimizeOnClose=false
MinimizeToTray=false
ShowTrayIcon=false
#+end_src

*** Deploy Configuration

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    - name: Create KeePassXC config directory
      file:
        path: "/home/{{ dev_user }}/.config/keepassxc"
        state: directory
        owner: "{{ dev_user }}"
        group: "{{ dev_user }}"
        mode: '0700'
      tags: [privacy, keepassxc, config]

    - name: Deploy KeePassXC configuration
      template:
        src: ../configs/templates/keepassxc.ini.j2
        dest: "/home/{{ dev_user }}/.config/keepassxc/keepassxc.ini"
        owner: "{{ dev_user }}"
        group: "{{ dev_user }}"
        mode: '0600'
        force: no  # Preserve user customizations on re-runs
      tags: [privacy, keepassxc, config]
#+end_src

** Privacy Verification Script

#+begin_src bash :tangle ../configs/templates/check-privacy.sh.j2
#!/bin/bash
# Verify privacy infrastructure configuration

echo "=== Privacy Infrastructure Check ==="
echo ""

# Check Tor is running
echo "--- Tor Service ---"
if systemctl is-active --quiet tor; then
    echo "✓ Tor service running"
else
    echo "✗ Tor service NOT running"
fi

# Test Tor SOCKS proxy
echo ""
echo "--- Tor SOCKS Proxy ---"
if timeout 10 curl --socks5 127.0.0.1:{{ tor_socks_port }} https://check.torproject.org/api/ip 2>/dev/null | grep -q '"IsTor":true'; then
    echo "✓ Tor SOCKS proxy working"
    IP=$(curl --socks5 127.0.0.1:{{ tor_socks_port }} -s https://api.ipify.org 2>/dev/null)
    echo "  Exit IP: $IP"
else
    echo "✗ Tor SOCKS proxy not working"
fi

# Check I2P service
echo ""
echo "--- I2P Service ---"
if systemctl is-active --quiet i2pd; then
  echo "✓ I2P service running"
else
  echo "✗ I2P service NOT running"
fi

# I2P SAM bridge
if timeout 5 bash -c "echo -e 'HELLO VERSION\n' | nc 127.0.0.1 7656" 2>/dev/null | grep -q "HELLO REPLY"; then
  echo "✓ I2P SAM bridge responding"
else
  echo "✗ I2P SAM bridge not responding"
fi

# I2P address
if [ -f /etc/monero/i2p-address.txt ]; then
  I2P_ADDR=$(cat /etc/monero/i2p-address.txt)
  if [ -n "$I2P_ADDR" ]; then
    echo "✓ I2P address configured: ${I2P_ADDR:0:20}...${I2P_ADDR: -10}"
  else
    echo "⚠ I2P address file empty (may still be generating)"
  fi
else
  echo "✗ I2P address file not found"
fi

# Check Tor Browser
echo ""
echo "--- Tor Browser ---"
if [ -x /usr/local/bin/tor-browser ]; then
    echo "✓ Tor Browser installed"
    echo "  Launch: tor-browser"
else
    echo "✗ Tor Browser not found"
fi

# Check KeePassXC
echo ""
echo "--- KeePassXC ---"
if command -v keepassxc &> /dev/null; then
    echo "✓ KeePassXC installed"
    echo "  Launch: keepassxc"
else
    echo "✗ KeePassXC not found"
fi

echo ""
echo "Next: Configure privacy wrappers (Phase 4) for git/SSH operations"
echo ""
#+end_src

** Deploy Helper Scripts

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # Privacy Infrastructure Helper Scripts
    # ------------------------------------------------------------------------

    - name: Deploy privacy infrastructure helper scripts
      template:
        src: "../configs/templates/{{ item }}.j2"
        dest: "/usr/local/bin/{{ item }}"
        mode: '0755'
      loop:
        - i2p-status.sh
        - check-privacy.sh
      tags: [privacy, scripts]
#+end_src

** Verify Privacy Infrastructure

#+begin_src yaml :tangle ../ansible/fragments/03-privacy.yml
    # ------------------------------------------------------------------------
    # Privacy Infrastructure Verification
    # ------------------------------------------------------------------------

    - name: Wait for Tor to start
      pause:
        seconds: 5
      tags: [privacy, verify]

    - name: Check Tor service status
      systemd:
        name: tor
      register: tor_status
      tags: [privacy, verify]

    - name: Test Tor SOCKS proxy
      shell: |
        curl --socks5 127.0.0.1:{{ tor_socks_port }} \
             --max-time 30 \
             https://check.torproject.org/api/ip 2>/dev/null || echo "failed"
      register: tor_test
      changed_when: false
      tags: [privacy, verify]

    - name: Verify I2P service status
      systemd:
        name: i2pd
      register: i2pd_status
      tags: [privacy, verify]

    - name: Verify Tor Browser installation
      stat:
        path: /usr/share/applications/tor-browser.desktop
      register: tor_browser_desktop
      tags: [privacy, verify]

    - name: Display privacy infrastructure status
      debug:
        msg:
          - "=== Privacy Infrastructure Complete ==="
          - ""
          - "Tor Service: {{ tor_status.status.ActiveState }}"
          - "Tor SOCKS Proxy: 127.0.0.1:{{ tor_socks_port }}"
          - "Tor test result: {{ tor_test.stdout }}"
          - ""
          - "I2P Service: {{ i2pd_status.status.ActiveState }}"
          - "I2P SAM Bridge: 127.0.0.1:7656"
          - "{% if i2p_address_raw.stdout is defined and i2p_address_raw.stdout != '' %}I2P address: {{ i2p_address_raw.stdout }}{% else %}I2P address: Generating (check i2p-status.sh in ~1 minute){% endif %}"
          - ""
          - "Tor Browser: {% if tor_browser_desktop.stat.exists %}Installed (launch: tor-browser){% else %}Not found{% endif %}"
          - "KeePassXC: Installed (launch: keepassxc)"
          - ""
          - "Infrastructure ready for application wrappers (Phase 4)"
          - "Verify: check-privacy.sh"
          - ""
      tags: [privacy, verify]
#+end_src

** Notes

*** Quick Operations

#+begin_example
# Verify privacy infrastructure
check-privacy.sh

# Check I2P status
i2p-status.sh

# Launch Tor Browser
tor-browser

# Launch KeePassXC
keepassxc
#+end_example

*** Network Routing Infrastructure

**Tor daemon:**
- SOCKS proxy on port {{ tor_socks_port }}
- Used by application wrappers (git, SSH, etc.)
- Test: `curl --socks5 127.0.0.1:{{ tor_socks_port }} https://check.torproject.org/api/ip`

**I2P daemon:**
- SAM bridge on port 7656
- Used by Monero node for P2P privacy
- Test: `i2p-status.sh`

**Monero node routing:**
- Transaction broadcast: I2P primary, Tor fallback
- P2P connections: I2P hidden service
- Blockchain sync: Clearnet (sybil protection)

Reference: https://github.com/monero-project/monero/blob/master/docs/ANONYMITY_NETWORKS.md

*** Tor Browser Updates

Check for new versions: https://www.torproject.org/download/

To update:
1. Edit config.yml: `tor_browser_version: "X.Y.Z"`
2. Remove old: `sudo rm -rf /opt/tor-browser`
3. Re-run phase: `ansible-playbook playbook.yml --tags privacy`

Checksums are verified automatically during download.

*** KeePassXC Configuration

See Appendix: KeePassXC Setup for comprehensive password management guide.

*** GitHub Browser Infrastructure

The GitHub browser wrapper uses a shared Tor Browser profile for all GitHub-authenticated apps. This provides:
- Persistent GitHub session across app launches
- Shared Tor circuit (same exit node)
- Session isolation from main Tor Browser

**Usage:**
- Launch GitHub: Desktop icon or `github-browser.sh`
- First launch: Opens Tor Browser, log into GitHub
- Subsequent launches: Focuses existing window
- Keep browser open = stay logged in
- Close browser = log out

**Adding more apps:**
See Phase 4 (privacy-wrappers) for pattern to add Element, etc.

*** I2P vs Tor

Monero recommends I2P for P2P connections:
- Designed for peer-to-peer networks (not client-server)
- No exit nodes (all traffic within I2P network)
